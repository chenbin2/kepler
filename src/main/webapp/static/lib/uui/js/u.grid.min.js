!function($,window,document,undefined){var dataSource=function(a,b){this.defaults={},this.gridComp=b,this.options=$.extend({},this.defaults,a),this.rows=new Array,this.hasParentRows=new Array,this.nothasParentRows=new Array,this.sortRows()},gridCompColumn=function(a,b){this.defaults={width:200,sortable:!0,canDrag:!0,fixed:!1,visible:!0,sumCol:!1,editable:!1,autoExpand:!1,editType:"text",dataType:"string",format:"yyyy-MM-dd hh:mm:ss"};var c={sortable:b.sortable,canDrag:b.canDrag,editable:b.editable,width:b.columnWidth};"Date"==a.dataType&&(this.defaults.format="yyyy-MM-dd"),this.options=$.extend({},this.defaults,c,a),this.firstColumn=!1},gridComp=function(a,b){this.dataSource=dataSource,this.gridCompColumn=gridCompColumn,this.ele=a[0],this.$ele=a,this.defaults={id:"grid",width:"100%",height:"100%",columnWidth:200,sortable:!0,canDrag:!0,showHeader:!0,columnMenu:!0,showNumCol:!1,multiSelect:!1,showSumRow:!1,editable:!1,showTree:!1,autoExpand:!0,onBeforeRowSelected:function(){return!0},onRowSelected:function(){return!0},onBeforeRowUnSelected:function(){return!0},onRowUnSelected:function(){return!0},onBeforeAllRowSelected:function(){return!0},onAllRowSelected:function(){return!0},onBeforeAllRowUnSelected:function(){return!0},onAllRowUnSelected:function(){return!0},onBeforeRowEditConfirm:function(){return!0}},this.transDefault={ml_show_column:"显示/隐藏列",ml_clear_set:"清除设置",ml_no_rows:"无数据"},this.transMap=$.extend({},this.transDefault,b.transMap),this.options=$.extend({},this.defaults,b),this.gridCompColumnArr=new Array,this.gridCompColumnFixedArr=new Array,this.basicGridCompColumnArr=new Array,this.treeLeft=10,this.multiSelectWidth=40,this.numWidth=40,this.multiWidth=40,this.headerHeight=34,this.countContentHeight=!0,this.minColumnWidth=80,this.columnMenuWidth=160,this.scrollBarHeight=16,this.initGrid()};gridComp.prototype={initGrid:function(){var a=this;this.initOptions(),this.initVariable(),this.initGridCompColumn(),this.initDataSource(),this.createDivs(),setInterval(function(){a.setIntervalFun.call(a)},100)},initOptions:function(){this.options.width=this.formatWidth(this.options.width),this.options.height=this.formatWidth(this.options.height),"100%"==this.options.height&&(this.countContentHeight=!1)},initVariable:function(){this.selectRows=new Array,this.selectRowsObj=new Array,this.allRows=new Array,this.mouseUpX="mouseUpX",this.mouseUpY="mouseUpY",this.mouseDownX="mouseDownX",this.mouseDownY="mouseDownY",this.mouseMoveX="mouseMoveX",this.mouseMoveY="mouseMoveY",this.scrollLeft=0,this.scrollTop=0,this.showType="",this.createGridFlag=!1,this.createFormFlag=!1,this.fixedWidth=0,this.leftW=0,this.wholeWidth=0,this.halfWholeWidth=0,this.wholeHeight=0,this.rowHeight=0,this.contentWidth=0,this.contentMinWidth=0,this.exceptContentHeight=0,this.contentHeight=0,this.columnClickX=0,this.columnClickY=0,this.$sd_storageData=null,this.columnMenuMove=!1,this.createColumnMenuFlage=!1,this.eidtRowIndex=-1,this.overWidth=!1,this.firstColumn=!0;var a=window.location.href,b=a.indexOf("?");b>0&&(a=a.substring(0,b)),this.localStorageId=this.options.id+a,this.options.showNumCol&&(this.leftW+=this.numWidth),this.options.multiSelect&&(this.leftW+=this.multiWidth),this.options.showHeader&&(this.exceptContentHeight+=this.headerHeight)},clearVariable:function(){},initGridCompColumn:function(){var a=this;this.options.columns&&$.each(this.options.columns,function(b){var c=new gridCompColumn(this,a.options);a.gridCompColumnArr[b]=c;var d=new gridCompColumn(this,a.options);a.basicGridCompColumnArr[b]=d});var b=this.getGridCompColumnArrFromLocal();null!=b&&(this.gridCompColumnArr=b,$.each(this.gridCompColumnArr,function(){for(var b=this.options.field,c=0;c<a.options.columns.length;c++){var d=a.options.columns[c];if(d.field==b){var e=$.extend({},d,this.options);this.options=e;break}}})),this.initGridCompFixedColumn(),this.columnsVisibleFun()},initGridCompFixedColumn:function(){var a=this,b=0;$.each(this.gridCompColumnArr,function(){1==this.options.fixed&&this.options.visible&&(this.firstCoulmn=a.firstColumn,a.firstColumn=!1,a.gridCompColumnFixedArr.push(this),b+=parseInt(this.options.width))}),this.fixedWidth=b,$.each(this.gridCompColumnFixedArr,function(b){for(var b=a.gridCompColumnArr.length;b>-1;b--)if(a.gridCompColumnArr[b]==this){a.gridCompColumnArr.splice(b,1);break}})},initDataSource:function(){this.dataSourceObj=new dataSource(this.options.dataSource,this)},createDivs:function(){var a='<div id="'+this.options.id+'" data-role="grid" class="ufida-grid" style="width:'+this.options.width+";height:"+this.options.height+'">';a+="</div>",this.ele.insertAdjacentHTML("afterBegin",a);var a='<div id="'+this.options.id+'_top" class="ufida-grid-top"></div>';this.ele.insertAdjacentHTML("afterBegin",a),this.initEventFun(),this.widthChangeFunc()},repaintDivs:function(){this.repaintGridDivs()},createGridDivs:function(){if(!this.createGridFlag){var a='<div id="'+this.options.id+'_grid" class="ufida-grid-grid">';this.options.showHeader&&(a+=this.createColumnMenu(),a+=this.createHeader()),a+=this.createContent(),this.options.editable&&(a+=this.createContentEditMenu()),a+="</div>",$("#"+this.options.id)[0].insertAdjacentHTML("afterBegin",a),this.headerFirstClassFun(),this.initGridEventFun(),this.afterGridDivsCreate(),this.createGridFlag=!0}},repaintGridDivs:function(){$("#"+this.options.id+"_grid").remove(),this.createGridFlag=!1,this.createGridDivs(),this.countWidth(),$("#"+this.options.id+"_content")[0].scrollLeft=this.scrollLeft},createColumnMenu:function(){var a='<div class="ufida-grid-column-menu" id="'+this.options.id+'_column_menu">';return a+='<ul data-role="menu" role="menubar" class="ufida-grid-column-menu-ul" id="'+this.options.id+'_column_menu_ul">',a+='<li class="ufida-grid-column-menu-li" role="menuitem">',a+='<div class="ufida-grid-column-menu-div1" id="'+this.options.id+'_showColumn">',a+='<span class="ufida-grid-column-menu-span">'+this.transMap.ml_show_column+"</span>",a+='<div class="ufida-grid-column-menu-div3 fa fa-caret-right"></div>',a+="</div></li>",a+='<li class="ufida-grid-column-menu-li" role="menuitem">',a+='<div class="ufida-grid-column-menu-div1" id="'+this.options.id+'_clearSet">',a+='<span class="ufida-grid-column-menu-span">'+this.transMap.ml_clear_set+"</span>",a+="</div></li>",a+="</ul></div>",a+='<div class="ufida-grid-column-menu" id="'+this.options.id+'_column_menu_columns">',a+='<ul data-role="menu" role="menubar" class="ufida-grid-column-menu-columns-ul" id="'+this.options.id+'_column_menu_columns_ul">',$.each(this.gridCompColumnArr,function(b){a+='<li class="ufida-grid-column-menu-columns-li" role="menuitem" index="'+b+'">',a+='<div class="ufida-grid-column-menu-columns-div1">';var c="";this.options.visible&&(c="checked"),a+='<div class="ufida-grid-column-menu-columns-div2"><input type="checkbox" '+c+"></div>",a+='<span class="ufida-grid-column-menu-columns-span">'+this.options.title+"</span>",a+="</div></li>"}),a+="</ul></div>"},createHeader:function(){var a='<div class="ufida-grid-header" id="'+this.options.id+'_header"><div class="ufida-grid-header-wrap" id="'+this.options.id+'_header_wrap" data-role="resizable">';return(this.options.multiSelect||this.options.showNumCol)&&(a+='<div id="'+this.options.id+'_header_left" class="ufida-grid-header-left" style="width:'+this.leftW+'px;">',this.options.multiSelect&&(a+='<div class="ufida-grid-header-multi-select" style="width:'+this.multiWidth+'px;"><input type="checkbox" id="'+this.options.id+'_header_multi_input"></div>'),this.options.showNumCol&&(a+='<div class="ufida-grid-header-num" style="width:'+this.numWidth+'px;"></div>'),a+="</div>"),a+=this.createHeaderTable("fixed"),a+=this.createHeaderTable(),a+="</div>",a+='<div class="ufida-grid-header-resize-handle" id="'+this.options.id+'_resize_handle"><div class="ufida-grid-header-resize-handle-inner"></div></div>',a+="</div>"},createHeaderTable:function(a){var b,c,d;"fixed"==a?(b=parseInt(this.leftW),c="absolute;width:"+this.fixedWidth+"px;z-index:11;background:#F9F9F9;",d="fixed_"):(b=parseInt(this.leftW)+parseInt(this.fixedWidth),c="relative;",d="",this.contentMinWidth>0&&(c+="min-width:"+this.contentMinWidth+"px;"));var e='<table role="grid" id="'+this.options.id+"_header_"+d+'table" style="position:'+c+";left:"+b+'px">';return e+=this.createColgroup(a),e+='<thead role="rowgroup" id="'+this.options.id+"_header_"+d+'thead">',e+=this.createThead(a),e+="</thead></table>"},createColgroup:function(a){var b,c=this,d="<colgroup>";return b="fixed"==a?this.gridCompColumnFixedArr:this.gridCompColumnArr,$.each(b,function(){d+="<col",this.options.width&&!this.options.autoExpand?d+=' style="width:'+c.formatWidth(this.options.width)+'"':this.options.autoExpand&&(d+=' style="min-width:'+c.formatWidth(c.minColumnWidth)+'"'),d+=">"}),d+="</colgroup>"},createThead:function(a){var b,c=this,d='<tr role="row">',e=0;return b="fixed"==a?this.gridCompColumnFixedArr:this.gridCompColumnArr,$.each(b,function(b){var f=e;0==this.options.visible?f=-1:e++,d+='<th role="columnheader" data-filed="'+this.options.field+'" rowspan="1" class="ufida-grid-header-th" field="'+this.options.field+'" index="'+b+'" visibleIndex="'+f+'">',d+='<div class="ufida-grid-header-link" field="'+this.options.field+'" title="'+this.options.title+'">'+this.options.title+"</div>",c.options.columnMenu&&"fixed"!=a&&(d+='<div class="ufida-grid-header-columnmenu fa fa-bars " field="'+this.options.field+'"></div>'),d+="</th>"}),d+="</tr>"},createContent:function(){var a="";if(this.countContentHeight){var b=$("#"+this.options.id)[0].offsetHeight;this.wholeHeight=b,b>0&&(this.contentHeight=parseInt(b)-this.exceptContentHeight>0?parseInt(b)-this.exceptContentHeight:0,a='style="max-height:'+this.contentHeight+'px;"')}var c='<div id="'+this.options.id+'_content" class="ufida-grid-content" '+a+">";return(this.options.showNumCol||this.options.multiSelect)&&(c+=this.createContentLeft(),this.options.showSumRow&&(c+='<div class="ufida-grid-content-left-sum-bottom" id="'+this.options.id+'_content_left_sum_bottom" style="width:'+(this.leftW+this.fixedWidth)+'px">',c+="</div>"),c+='<div class="ufida-grid-content-left-bottom" id="'+this.options.id+'_content_left_bottom" style="width:'+(this.leftW+this.fixedWidth)+'px">',c+="</div>"),c+=this.createContentTable("fixed"),c+=this.createContentTable(),c+="</div>"},createNoRowsDiv:function(){var a="";this.contentMinWidth>0&&(a+='stype="width:'+this.contentMinWidth+'px;"');var b='<div class="ufida-grid-noRowsDiv"'+a+' id="'+this.options.id+'_noRows"></div>';return b+='<div class="ufida-grid-noRowsShowDiv" id="'+this.options.id+'_noRowsShow">'+this.transDefault.ml_no_rows+"</div>"},createContentTable:function(a){var b,c,d,e,f,g;e=this.countContentHeight?"max-height:"+this.contentHeight+"px;":"","fixed"==a?(b=parseInt(this.leftW),c="fixed_",f="fixed-",d='style="position:absolute;width:'+this.fixedWidth+"px;left:"+b+"px;"+e+'"',g='style="width:'+this.fixedWidth+'px;"'):(b=parseInt(this.leftW)+parseInt(this.fixedWidth),c="",f="",d='style="position:relative;left:'+b+"px;"+e,this.contentMinWidth>0&&(d+="width:"+this.contentMinWidth+'px;"'),d+='"',g="",this.contentMinWidth>0&&(g='style="min-width:'+this.contentMinWidth+'px;"'));var h='<div id="'+this.options.id+"_content_"+c+'div" class="ufida-grid-content-'+f+'div" '+d+">";return h+='<table role="grid" id="'+this.options.id+"_content_"+c+'table" '+g+">",h+=this.createColgroup(a),h+='<thead role="rowgroup" id="'+this.options.id+"_content_"+c+'thead" style="display:none">',h+=this.createThead(a),h+="</thead>",h+=this.createContentRows(a),h+="</table>","fixed"!=a&&(h+=this.createNoRowsDiv()),h+="</div>"},createContentLeft:function(){var a=this,b="",c=0;return this.options.multiSelect&&(b+='<div class="ufida-grid-content-left" id="'+this.options.id+'_content_multiSelect" style="width:'+this.multiSelectWidth+'px;">',this.dataSourceObj.rows&&$.each(this.dataSourceObj.rows,function(){b+=a.createContentLeftMultiSelectRow(this)}),b+="</div>",c+=this.multiSelectWidth),this.options.showNumCol&&(b+='<div class="ufida-grid-content-left" id="'+this.options.id+'_content_numCol" style="width:'+this.numWidth+"px;left:"+c+'px;">',this.dataSourceObj.rows&&$.each(this.dataSourceObj.rows,function(c){b+=a.createContentLeftNumColRow(c)}),b+="</div>"),b},createContentLeftMultiSelectRow:function(a){var b="";!this.options.autoExpand&&a.level>0&&(b="display:none;");var c='<div style="width:'+this.multiSelectWidth+"px;"+b+'" class="ufida-grid-content-multiSelect"><input type="checkbox"></div>';return c},createContentLeftNumColRow:function(a){var b='<div style="width:'+this.numWidth+'px;" class="ufida-grid-content-num">'+(a+1)+"</div>";return b},createContentRows:function(a){var b,c=this,d="";return b="fixed"==a?"fixed_":"",this.dataSourceObj.rows&&(d+='<tbody role="rowgroup" id="'+this.options.id+"_content_"+b+'tbody">',$.each(this.dataSourceObj.rows,function(){d+=c.createContentOneRow(this,a)}),c.options.showSumRow&&this.dataSourceObj.rows&&this.dataSourceObj.rows.length>0&&(d+=c.createSumRow(a)),d+="</tbody>"),d},createContentOneRow:function(a,b){var c="";!this.options.autoExpand&&a.level>0&&(c='style="display:none"');var d='<tr role="row" '+c+">";return d+=this.createContentOneRowTd(a,b),d+="</tr>"},repaintRow:function(a,b,c){var d=$(a),e=$("tr",d.parent()).index(d);a.innerHTML=this.createContentOneRowTd(b,c),this.renderTypeFun(e)},createContentOneRowTd:function(a,b){var c,d=this,e="";c="fixed"==b?this.gridCompColumnFixedArr:this.gridCompColumnArr;var f=a.value;return $.each(c,function(){var b=this.options.field,c=$(f).attr(b);c=d.getString(c,"");var g=(this.options.renderType,""),h="";if(d.options.showTree&&this.firstColumn){var i=parseInt(d.treeLeft)*parseInt(a.level);g='style="position:relative;',a.hasChild?h=d.options.autoExpand?'<span class=" fa fa-minus-square-o ufida-grid-content-tree-span"></span>':'<span class=" fa fa-plus-square-o ufida-grid-content-tree-span"></span>':i+=18,g+="left:"+i+'px;"'}e+='<td role="rowcell" title="'+c+'"><div class="ufida-grid-content-td-div" '+g+">"+h+"<span>"+c+"</span></div></td>"}),e},createSumRow:function(a){var b,c,d=this;"fixed"==a?(b="fixed_",c=this.gridCompColumnFixedArr):(b="",c=this.gridCompColumnArr);var e=parseInt(this.wholeHeight)-this.exceptContentHeight-48-this.scrollBarHeight;e=e>0?e:0;var f='<tr role="row" class="ufida-grid-content-sum-row" id="'+this.options.id+"_content_"+b+'sum_row" style="top:'+e+'px;">';return $.each(c,function(){var a=this.options.field,b=d.dataSourceObj.getSumValue(a,this,d);f+='<td role="rowcell" title="'+b+'"><div class="ufida-grid-content-td-div"><span>'+b+"</span></div></td>"}),f+="</tr>"},repairSumRow:function(){if($("#"+this.options.id+"_content_div tbody .ufida-grid-content-sum-row").remove(),this.dataSourceObj.rows&&this.dataSourceObj.rows.length>0){var a=this.createSumRow();$("#"+this.options.id+"_content_div tbody")[0].insertAdjacentHTML("beforeEnd",a)}if($("#"+this.options.id+"_content_fixed_div tbody .ufida-grid-content-sum-row").remove(),this.dataSourceObj.rows&&this.dataSourceObj.rows.length>0){var a=this.createSumRow("fixed");$("#"+this.options.id+"_content_fixed_div tbody")[0].insertAdjacentHTML("beforeEnd",a)}},rePairContentRows:function(){var a=$("#"+this.options.id+"_content_tbody").parent();$("#"+this.options.id+"_content_tbody").remove();var b=this.createContentRows();a[0]&&a[0].insertAdjacentHTML("afterBegin",b)},createContentEditMenu:function(){var a='<div class="ufida-grid-content-edit-menu" id="'+this.options.id+'_content_edit_menu">';return a+='<button type="button" class="ufida-grid-content-edit-menu-button fa fa-check" id="'+this.options.id+'_content_edit_menu_ok">Ok</button>',a+='<button type="button" class="ufida-grid-content-edit-menu-button fa fa-times" id="'+this.options.id+'_content_edit_menu_cancel">Cancel</button>',a+="</div>"},createFromDivs:function(){if(!this.createFormFlag){var a='<div id="'+this.options.id+'_form" class="ufida-grid-form">';a+=this.createFromContent(),$("#"+this.options.id)[0].insertAdjacentHTML("afterBegin",a),this.createFormFlag=!0}},createFromContent:function(){var a='<div class="ufida-grid-form-content" id="'+this.options.id+'_form_content" class="ufida-grid-content">';return a+='<table role="grid" id="'+this.options.id+'_form_content_table">',a+=this.createFormContentRows(),a+="</table>"},createFormContentRows:function(){var a=this,b="";return this.dataSourceObj.rows&&(b+='<tbody role="rowgroup" id="'+this.options.id+'_form_content_tbody">',$.each(this.dataSourceObj.rows,function(){b+='<tr role="row"><td role="rowcell">';var c=this.value;$.each(a.gridCompColumnArr,function(){var a=this.options.field,d=this.options.title,e=$(c).attr(a);b+="<div>"+d+":</div>",b+="<div>"+e+"</div>"}),b+="</td></tr>"}),b+="</tbody>"),b},initEventFun:function(){var a=this;$("#"+this.options.id).on("mousedown",function(b){if($(b.target).closest("#"+a.options.id+"_header").length>0){a.mouseDownX=b.clientX,a.mouseDownY=b.clientY;var c=$(b.target).closest("th")[0];a.swapColumnStart(b,c),b.preventDefault()}else $(b.target).closest("#"+a.options.id+"_content").length>0}),$("#"+this.options.id).on("mousemove",function(b){if(a.countWidthFlag||(a.countWidth(b),a.countWidthFlag=!0),$(b.target).closest("#"+a.options.id+"_header").length>0){var c=$(b.target).closest("th")[0];a.headerThDrag(b,c)}a.mouseMoveX=b.clientX,a.mouseMoveY=b.clientY,a.mouseMoveX==a.mouseDownX&&a.mouseDownY==a.mouseMoveY||"mouseDownX"==a.mouseDownX||(a.swapColumnFlag=!0),a.dragFun(b),a.swapColumnFun(b),b.stopPropagation()}),$("#"+this.options.id+"_top").on("mousemove",function(b){a.mouseMoveX=b.clientX,a.mouseMoveY=b.clientY,a.mouseMoveX==a.mouseDownX&&a.mouseDownY==a.mouseMoveY||"mouseDownX"==a.mouseDownX||(a.swapColumnFlag=!0),a.dragFun(b),a.swapColumnFun(b),b.stopPropagation()}),$("#"+this.options.id).on("mouseup",function(b){if($(b.target).closest("#"+a.options.id+"_header").length>0){if(a.mouseUpX=b.clientX,a.mouseUpY=b.clientY,a.mouseDownX==a.mouseUpX&&a.mouseDownY==a.mouseUpY){a.columnClickX=b.clientX,a.columnClickY=b.clientY;var c=$(b.target).closest("th")[0];$(b.target).hasClass("ufida-grid-header-columnmenu")?($("#"+a.options.id+"_column_menu").css("display","block"),$("#"+a.options.id+"_column_menu").css("left",c.attrRightTotalWidth-a.scrollLeft+a.leftW+a.fixedWidth-a.columnMenuWidth+1),$("#"+a.options.id+"_column_menu").css("top",a.headerHeight),a.ele.createColumnMenuFlage=!0):a.canSortable(b,c)}}else $(b.target).closest("#"+a.options.id+"_content").length>0;a.dragEnd(b),a.swapColumnEnd(b),a.mouseUpX="mouseUpX",a.mouseUpY="mouseUpY",a.mouseDownX="mouseDownX",a.mouseDownY="mouseDownY",a.mouseMoveX="mouseMoveX",a.mouseMoveY="mouseMoveY"}),$("#"+this.options.id+"_top").on("mouseup",function(b){a.dragEnd(b),a.swapColumnEnd(b),a.mouseUpX="mouseUpX",a.mouseUpY="mouseUpY",a.mouseDownX="mouseDownX",a.mouseDownY="mouseDownY",a.mouseMoveX="mouseMoveX",a.mouseMoveY="mouseMoveY"}),$(document).on("click",function(){0==a.columnMenuMove&&0==a.ele.createColumnMenuFlage&&$("#"+a.options.id+"_column_menu",a.$ele).css("display","none"),a.ele.createColumnMenuFlage=!1})},initGridEventFun:function(){var a=this;$("#"+this.options.id+"_resize_handle").on("mousedown",function(b){return a.dragStart(b),!1}),$("#"+this.options.id+"_content_div").on("scroll",function(){a.scrollLeft=this.scrollLeft,a.scrollTop=this.scrollTop,$("#"+a.options.id+"_header_table").css("left",a.leftW-a.scrollLeft+a.fixedWidth+"px"),$("#"+a.options.id+"_noRowsShow").css("left",a.scrollLeft+"px"),$("#"+a.options.id+"_content_multiSelect").css("top",-a.scrollTop+"px"),$("#"+a.options.id+"_content_numCol").css("top",-a.scrollTop+"px"),$("#"+a.options.id+"_content_fixed_div").css("top",-a.scrollTop+"px")}),$("#"+this.options.id+"_header_multi_input").on("click",function(){this.checked?a.setAllRowSelect():a.setAllRowUnSelect()}),$("#"+a.options.id+"_content .ufida-grid-content-left input").on("click",function(){var b=$($(this).parent()),c=$("div",b.parent()).index(b);this.checked?a.setRowSelect(c):a.setRowUnselect(c)}),$("#"+this.options.id+"_column_menu_ul").on("mousemove",function(){a.columnMenuMove=!0}),$("#"+this.options.id+"_column_menu_ul").on("mouseout",function(){a.columnMenuMove=!1}),$("#"+this.options.id+"_showColumn").on("mousemove",function(){a.hideMenuColumns&&clearTimeout(a.hideMenuColumns);var b=window.top.document.body.clientWidth;$("#"+a.options.id+"_column_menu_columns").css("display","block");var c=$("#"+a.options.id+"_column_menu").css("left"),d=parseInt(c)+a.columnMenuWidth,e=a.columnClickX+a.columnMenuWidth;e>b&&(d=parseInt(c)-a.columnMenuWidth),$("#"+a.options.id+"_column_menu_columns").css("left",d),$("#"+a.options.id+"_column_menu_columns").css("top",a.headerHeight),a.columnMenuMove=!0}),$("#"+this.options.id+"_showColumn").on("mouseout",function(){a.hideMenuColumns=setTimeout(function(){$("#"+a.options.id+"_column_menu_columns").css("display","none"),a.columnMenuMove=!1},200)}),$("#"+this.options.id+"_column_menu_columns").on("mousemove",function(){a.hideMenuColumns&&clearTimeout(a.hideMenuColumns),$("#"+a.options.id+"_column_menu_columns").css("display","block"),a.columnMenuMove=!0}),$("#"+this.options.id+"_column_menu_columns").on("mouseout",function(){a.hideMenuColumns=setTimeout(function(){$("#"+a.options.id+"_column_menu_columns").css("display","none"),a.columnMenuMove=!1},200)}),$("#"+this.options.id+"_clearSet").on("click",function(){a.clearLocalData(),a.gridCompColumnArr=a.cloneObj(a.basicGridCompColumnArr),a.repaintGridDivs()}),$("#"+this.options.id+"_column_menu_columns_ul li input").on("click",function(b){var c=$(this).closest("li").attr("index");if(a.gridCompColumnArr[c].options.visible){$(this)[0].checked=!1;var d=$("input:checked",$("#"+a.options.id+"_column_menu_columns_ul")).length;if(0==d)return void($(this)[0].checked=!0);a.setColumnVisibleByIndex(c,!1),a.gridCompColumnArr[c].options.visible=!1}else $(this)[0].checked=!0,a.setColumnVisibleByIndex(c,!0),a.gridCompColumnArr[c].options.visible=!0;a.saveGridCompColumnArrToLocal(),b.stopPropagation()}),$("#"+this.options.id+"_column_menu_columns_ul li").on("click",function(){var b=$(this).attr("index");if(a.gridCompColumnArr[b].options.visible){$("input",$(this))[0].checked=!1;var c=$("input:checked",$("#"+a.options.id+"_column_menu_columns_ul")).length;if(0==c)return void($("input",$(this))[0].checked=!0);a.setColumnVisibleByIndex(b,!1),a.gridCompColumnArr[b].options.visible=!1}else $("input",$(this))[0].checked=!0,a.setColumnVisibleByIndex(b,!0),a.gridCompColumnArr[b].options.visible=!0;a.saveGridCompColumnArrToLocal()}),$("#"+this.options.id+"_content_tbody tr").on("click",function(){{var b=$(this),c=$("tr",b.parent()).index(b),d=a.dataSourceObj.rows[c];d.childRowIndex}a.options.editable&&a.eidtRowIndex!=c&&(-1!=a.eidtRowIndex&&a.editOk(),a.editRow(this)),a.dataSourceObj.rows[c].checked?a.setRowUnselect(c):a.setRowSelect(c)}),$("#"+this.options.id+"_content_tbody tr td").on("click",function(){var b=$(this),c=b.parent(),d=$("tr",c.parent()).index(c),e=a.dataSourceObj.rows[d],f=e.childRowIndex,g=b.find(".fa-minus-square-o"),h=b.find(".fa-plus-square-o");if(g.length>0){if(g.removeClass("fa-minus-square-o").addClass("fa-plus-square-o"),f.length>0){var i=a.getAllChildRowIndex(e);$.each(i,function(){var b=$("tr:eq("+parseInt(this)+")",c.parent());b.css("display","none"),$("#"+a.options.id+"_content_multiSelect >div:nth-child("+(parseInt(this)+1)+")").css("display","none"),$(".fa-minus-square-o",b).removeClass("fa-minus-square-o").addClass("fa-plus-square-o")})}}else h.length>0&&(h.removeClass("fa-plus-square-o").addClass("fa-minus-square-o"),f.length>0&&$.each(f,function(){var b=$("tr:eq("+parseInt(this)+")",c.parent());b.css("display","");$("#"+a.options.id+"_content_multiSelect >div:nth-child("+(parseInt(this)+1)+")")[0];$("#"+a.options.id+"_content_multiSelect >div:nth-child("+(parseInt(this)+1)+")").css("display","")}))}),$("#"+this.options.id+"_content_edit_menu_ok").on("click",function(){a.editOk()}),$("#"+this.options.id+"_content_edit_menu_cancel").on("click",function(){a.editCancel()})},setIntervalFun:function(){this.widthChangeFunc(),this.changeHeightFun()},afterGridDivsCreate:function(){this.columnsVisibleFun(),this.countRowHeight(),this.renderTypeFun(),this.noRowsShowFun()},noRowsShowFun:function(){this.dataSourceObj.rows&&this.dataSourceObj.rows.length>0?($("#"+this.options.id+"_noRowsShow").css("display","none"),$("#"+this.options.id+"_noRows").css("display","none")):($("#"+this.options.id+"_noRowsShow").css("display","block"),$("#"+this.options.id+"_noRows").css("display","block"))},renderTypeFun:function(a,b){var c=this,a=parseInt(a),b=parseInt(b),d=a;b>0&&(d=parseInt(a+b-1)),$.each(this.gridCompColumnArr,function(d){c.renderTypeByColumn(this,d,a,b)})},renderTypeByColumn:function(a,b,c,d){var e=this,f=a.options.renderType,g=a.options.dataType,h=a.options.format,i=a.options.field,j=c;d>0&&(j=parseInt(c+d-1)),("function"==typeof f||"Date"==g||"DateTime"==g)&&$.each(e.dataSourceObj.rows,function(d){if(c>=0&&d>=c&&j>=d||isNaN(c)){var k=$("#"+e.options.id+"_content_tbody tr:eq("+d+") td:eq("+b+")")[0],l=$("#"+e.options.id+"_content_tbody tr:eq("+d+") td:eq("+b+") span:last-child")[0],m=$(this.value).attr(i);if(m=e.getString(m,""),"function"==typeof f)f.call(e,m,l,this,a);else if("Date"==g){var n=new Date(m);parseInt(n.valueOf())>0&&(m=n.format(h)),l.innerHTML=m,k.title=m}else if("DateTime"==g){var n=new Date(m);parseInt(n.valueOf())>0&&(m=n.format(h)),l.innerHTML=m,k.title=m}}})},countRowHeight:function(){$("#"+this.options.id+"_content_tbody tr")[0]&&(this.rowHeight=$("#"+this.options.id+"_content_tbody tr")[0].offsetHeight)},columnsVisibleFun:function(){var a=this,b=0;this.gridCompColumnFixedArr.length>0||(this.firstColumn=!0),$.each(this.gridCompColumnArr,function(){0==this.options.visible?(a.setColumnVisibleByColumn(this,!1),this.firstColumn=!1):(b+=parseInt(this.options.width),this.firstColumn=a.firstColumn,a.firstColumn=!1)}),this.contentWidth=b,$("#"+this.options.id+"_header_table").css("width",b+"px"),$("#"+this.options.id+"_content_table").css("width",b+"px"),$("#"+this.options.id+"_noRows").css("width",b+"px")},setColumnVisibleByColumn:function(a){var b=this.getIndexOfColumn(a);this.setColumnVisibleByIndex(b)},setColumnVisibleByIndex:function(a,b){if(a>=0){var c=this.gridCompColumnArr[a],d=this.getVisibleIndexOfColumn(c);if(b){var e="<col";this.gridCompColumnArr[a].options.width&&(e+=' style="width:'+this.formatWidth(this.gridCompColumnArr[a].options.width)+'"'),e+=">";var f=this.getNextVisibleInidexOfColumn(c);-1==f?($("#"+this.options.id+"_header col:last")[0].insertAdjacentHTML("afterEnd",e),$("#"+this.options.id+"_content col:last")[0].insertAdjacentHTML("afterEnd",e)):($("#"+this.options.id+"_header col:eq("+f+")")[0].insertAdjacentHTML("beforeBegin",e),$("#"+this.options.id+"_content col:eq("+f+")")[0].insertAdjacentHTML("beforeBegin",e)),$("#"+this.options.id+"_header th:eq("+a+")").css("display",""),$("td:eq("+a+")",$("#"+this.options.id+"_content tbody tr")).css("display","")}else $("#"+this.options.id+"_header col:eq("+d+")").remove(),$("#"+this.options.id+"_header th:eq("+a+")").css("display","none"),$("#"+this.options.id+"_content col:eq("+d+")").remove(),$("td:eq("+a+")",$("#"+this.options.id+"_content tbody tr")).css("display","none");this.countWidth(),this.saveGridCompColumnArrToLocal()}},getIndexOfColumn:function(a){for(var b=-1,c=0;c<this.gridCompColumnArr.length;c++)if(this.gridCompColumnArr[c]==a){b=c;break}return b},getVisibleIndexOfColumn:function(a){for(var b=-1,c=0,d=0;d<this.gridCompColumnArr.length;d++){if(this.gridCompColumnArr[d]==a){"none"!=$("#"+this.options.id+"_header th:eq("+d+")").css("display")&&(b=c);break}"none"!=$("#"+this.options.id+"_header th:eq("+d+")").css("display")&&c++}return b},getNextVisibleInidexOfColumn:function(a){for(var b=-1,c=!1,d=0,e=0;e<this.gridCompColumnArr.length;e++){if(this.gridCompColumnArr[e]==a&&(c=!0),1==c&&"none"!=$("#"+this.options.id+"_header th:eq("+e+")").css("display")){b=d;break}"none"!=$("#"+this.options.id+"_header th:eq("+e+")").css("display")&&d++}return b},dragStart:function(a){this.dragFlag=!0,this.dragStartX=a.clientX},dragFun:function(a){if(this.dragFlag){var b=$("#"+this.options.id+"_resize_handle")[0].nowTh,c=$(b),d=c.attr("visibleIndex");if(b){this.dragEndX=a.clientX;var e=this.dragEndX-this.dragStartX,f=b.attrWidth+e;cWidth=this.contentWidth+e,f>this.minColumnWidth&&($("#"+this.options.id+"_header_table col:eq("+d+")").css("width",f+"px"),$("#"+this.options.id+"_content_table col:eq("+d+")").css("width",f+"px"),$("#"+this.options.id+"_header_table").css("width",cWidth+"px"),$("#"+this.options.id+"_content_table").css("width",cWidth+"px"),$("#"+this.options.id+"_noRows").css("width",cWidth+"px"),this.gridCompColumnArr[d].options.width=f,this.gridCompColumnArr[d].options.autoExpand=!1)}$("#"+this.options.id+"_top").css("display","block")}},dragEnd:function(){this.dragFlag&&(this.countWidth(),this.saveGridCompColumnArrToLocal()),$("#"+this.options.id+"_resize_handle")[0].nowTh=null,this.dragFlag=!1,$("#"+this.options.id+"_top").css("display","none")},swapColumnStart:function(a,b){this.swapColumnEle=b,this.swapColumnStartX=a.clientX,this.swapColumnStartY=a.clientY},swapColumnFun:function(a){var b=this;if(this.swapColumnFlag){var c=this.swapColumnEle,d=$(c),e=c.gridCompColumn;if(0==$("#"+this.options.id+"_clue").length){var f=$('<div class="ufida-grid ufida-grid-header-drag-clue" id="'+this.options.id+'_clue" />').css({width:c.scrollWidth+"px",left:c.attrLeftTotalWidth-b.scrollLeft+b.leftW+b.fixedWidth+"px",top:"0px",paddingLeft:d.css("paddingLeft"),paddingRight:d.css("paddingRight"),lineHeight:d.height()+"px",paddingTop:d.css("paddingTop"),paddingBottom:d.css("paddingBottom")}).html(e.options.title||e.options.field).prepend('<span class="fa fa-ban ufida-grid-header-drag-status" />');$("#"+this.options.id)[0].insertAdjacentElement("afterBegin",f[0]),f.on("mousemove",function(){a.stopPropagation()})}this.swapColumnEndX=a.clientX,this.swapColumnEndY=a.clientY;var g=this.swapColumnEndX-this.swapColumnStartX,h=this.swapColumnEndY-this.swapColumnStartY;if($("#"+this.options.id+"_clue").css({left:c.attrLeftTotalWidth+g-b.scrollLeft+b.leftW+b.fixedWidth+"px",top:h+"px"}),0==$("#"+this.options.id+"_swap_top").length){var f=$('<span class="fa fa-sort-desc ufida-grid-header-swap-tip-span"  id="'+this.options.id+'_swap_top"/>');f.css({top:d.height()-6+"px"});var i=$('<span class="fa fa-sort-asc ufida-grid-header-swap-tip-span" id="'+this.options.id+'_swap_down" />');i.css({top:"6px"}),$("#"+this.options.id)[0].insertAdjacentElement("afterBegin",f[0]),$("#"+this.options.id)[0].insertAdjacentElement("afterBegin",i[0])}this.canSwap=!1,$("#"+this.options.id+"_header_table th").each(function(c){var d=$(this).offset().left,e=d+parseInt(this.attrWidth);if(0==c&&a.clientX<d)b.swapColumnEle!=this&&(b.swapToColumnEle="LeftEle",$("#"+b.options.id+"_swap_top").css({left:-b.scrollLeft-3+b.leftW+b.fixedWidth+"px",display:"block"}),$("#"+b.options.id+"_swap_down").css({left:-b.scrollLeft-3+b.leftW+b.fixedWidth+"px",display:"block"})),b.canSwap=!0;else if(d<a.clientX&&a.clientX<e&&b.swapColumnEle!=this&&parseInt($(this).attr("index"))+1!=parseInt($(b.swapColumnEle).attr("index")))return b.swapToColumnEle!=this&&(b.swapToColumnEle=this,$("#"+b.options.id+"_swap_top").css({left:this.attrRightTotalWidth-b.scrollLeft-3+b.leftW+b.fixedWidth+"px",display:"block"}),$("#"+b.options.id+"_swap_down").css({left:this.attrRightTotalWidth-b.scrollLeft-3+b.leftW+b.fixedWidth+"px",display:"block"})),b.canSwap=!0,!1}),this.canSwap?$(".ufida-grid-header-drag-status").removeClass("fa-ban").addClass("fa-plus-circle"):($("#"+this.options.id+"_swap_top").css("display","none"),$("#"+this.options.id+"_swap_down").css("display","none"),$(".ufida-grid-header-drag-status").removeClass("fa-plus-circle").addClass("fa-ban"),this.swapToColumnEle=null),$("#"+this.options.id+"_top").css("display","block")}},swapColumnEnd:function(){if(this.swapColumnFlag){if(this.swapToColumnEle){var a=this.swapColumnEle,b=this.swapToColumnEle,c=$(a).attr("index"),d=$(b).attr("index"),e=this.gridCompColumnArr[c];
this.gridCompColumnArr.splice(parseInt(d)+1,0,e),d>c?this.gridCompColumnArr.splice(c,1):this.gridCompColumnArr.splice(parseInt(c)+1,1),this.saveGridCompColumnArrToLocal(),this.repaintGridDivs()}$("#"+this.options.id+"_clue").remove(),$("#"+this.options.id+"_swap_top").css("display","none"),$("#"+this.options.id+"_swap_down").css("display","none")}this.swapColumnFlag=!1,$("#"+this.options.id+"_top").css("display","none")},canSortable:function(a,b){var c=this,d=$(b),e=d.attr("field"),f=c.getColumnAttr("sortable",e);f&&($(".fa-angle-up").parent().parent()[0]==b?($(".fa-angle-up").remove(),$(b.firstChild)[0].insertAdjacentHTML("beforeEnd",'<span class="fa fa-angle-down ufida-grid-header-sort-span" ></span>'),c.dataSourceObj.sortRows(e,"asc")):$(".fa-angle-down").parent().parent()[0]==b?($(".fa-angle-down").remove(),c.dataSourceObj.sortRows()):($(".fa-angle-up").remove(),$(".fa-angle-down").remove(),$(b.firstChild)[0].insertAdjacentHTML("beforeEnd",'<span class="fa fa-angle-up ufida-grid-header-sort-span"></span>'),c.dataSourceObj.sortRows(e,"desc")),c.rePairContentRows(),c.afterGridDivsCreate())},headerThDrag:function(a,b){if(!this.dragFlag&&!this.swapColumnFlag&&b&&b.gridCompColumn&&b.gridCompColumn.options.canDrag&&$("#"+this.options.id+"_resize_handle")[0].nowTh!=b){{$(b)}$("#"+this.options.id+"_resize_handle").css("left",b.attrRightTotalWidth-this.scrollLeft-4+this.leftW+this.fixedWidth),$("#"+this.options.id+"_resize_handle")[0].nowTh=b}},editRow:function(a){var b=$(a),c=this,d=$("tr",b.parent()).index(b);this.eidtRowIndex=d;var e=this.dataSourceObj.rows[d].value;this.editRowObj=this.cloneObj(e),$.each(this.gridCompColumnArr,function(a){if(this.options.editable){var d=$("td:eq("+a+")",b)[0],f=this.options.field,g=$(e).attr(f);c.editCell(d,g,f,this.options.editType,c.editRowObj)}}),$("#"+this.options.id+"_content_edit_menu").css("display","block"),$("#"+this.options.id+"_content_edit_menu").css("left",this.leftW+this.fixedWidth+"px");var f=this.rowHeight*(d+1)+this.headerHeight+1;$("#"+this.options.id+"_content_edit_menu").css("top",f+"px")},editOk:function(){var a=$("#"+this.options.id+"_content_tbody tr:eq("+this.eidtRowIndex+")")[0],b=this.dataSourceObj.rows[this.eidtRowIndex];"function"==typeof this.options.onBeforeRowEditConfirm&&this.options.onBeforeRowEditConfirm.call(this,this.editRowObj,this.eidtRowIndex)&&(b.value=this.editRowObj,this.repaintRow(a,b),$("#"+this.options.id+"_content_edit_menu").css("display","none"),this.eidtRowIndex=-1)},editCancel:function(){var a=$("#"+this.options.id+"_content_tbody tr:eq("+this.eidtRowIndex+")")[0],b=this.dataSourceObj.rows[this.eidtRowIndex];this.repaintRow(a,b),$("#"+this.options.id+"_content_edit_menu").css("display","none"),this.eidtRowIndex=-1},editCell:function(a,b,c,d,e){"text"==d?(a.innerHTML='<input type="text" value="'+b+'" field="'+c+'" style="width:100%;height:100%;min-height:20px;font-size:12px;">',$("input",$(a)).on("blur",function(){$(e).attr(c,this.value)})):"function"==typeof d&&d.call(this,a,b,c,e)},headerFirstClassFun:function(){$("#"+this.options.id+"_grid .ufida-grid-header-th-first").removeClass("ufida-grid-header-th-first"),$("#"+this.options.id+"_grid th:eq(0)").addClass("ufida-grid-header-th-first")},countWidth:function(){var a=this;this.contentWidth=0,$("#"+this.options.id+"_header_table th").each(function(b){var c=this.offsetWidth;c>0&&c<a.minColumnWidth&&(c=a.minColumnWidth);var d=a.gridCompColumnArr[b];this.attrLeftTotalWidth=a.contentWidth,a.contentWidth+=c,!$("#"+a.options.id+"_resize_handle")[0].nowTh&&d.options.canDrag&&($("#"+a.options.id+"_resize_handle").css("left",c-4+a.leftW),$("#"+a.options.id+"_resize_handle")[0].nowTh=this),this.gridCompColumn=d,this.attrWidth=c,this.attrRightTotalWidth=a.contentWidth}),$("#"+this.options.id+"_header_table").css("width",this.contentWidth+"px"),$("#"+this.options.id+"_content_table").css("width",this.contentWidth+"px"),$("#"+this.options.id+"_noRows").css("width",this.contentWidth+"px")},widthChangeFunc:function(){var a=this;if($("#"+this.options.id)[0]){var b=$("#"+this.options.id)[0].offsetWidth;if(this.wholeWidth!=b){this.wholeWidth=b;var c=parseInt(b/2);this.fixedWidth>c&&(this.fixedWidth=c),b>300&&("form"==this.showType||""==this.showType)?(this.createGridDivs(),$("#"+this.options.id+"_form").css("display","none"),$("#"+this.options.id+"_grid").css("display","block"),this.showType="grid"):b>0&&300>b&&("grid"==this.showType||""==this.showType)&&(this.createFromDivs(),$("#"+this.options.id+"_grid").css("display","none"),$("#"+this.options.id+"_form").css("display","block"),this.showType="form","function"==typeof this.options.afterCreate&&this.options.afterCreate.call(this)),b>300&&(this.contentMinWidth=parseInt(this.wholeWidth)-parseInt(this.leftW)-parseInt(this.fixedWidth),this.contentMinWidth<0&&(this.contentMinWidth=0),setTimeout(function(){$("#"+a.options.id+"_content_div").css("width",a.contentMinWidth+"px"),$("#"+a.options.id+"_content_table").css("min-width",a.contentMinWidth+"px"),$("#"+a.options.id+"_header_table").css("min-width",a.contentMinWidth+"px"),"function"==typeof a.options.afterCreate&&a.options.afterCreate.call(a)},100))}}},changeHeightFun:function(){if(this.countContentHeight){var a=this.wholeHeight,b=$("#"+this.options.id)[0].offsetHeight;if(this.wholeHeight=b,a!=b){var c=b-this.exceptContentHeight>0?b-this.exceptContentHeight:0;$("#"+this.options.id+"_content").css("height",c+"px"),$("#"+this.options.id+"_content_div").css("height",c+"px")}}},getLocalData:function(){if(null==window.localStorage)return null;if(null!=this.$sd_storageData)return this.$sd_storageData;if(null==window.localStorage.getItem(this.localStorageId))try{window.localStorage.setItem(this.localStorageId,"{}")}catch(e){return null}var storageDataStr=window.localStorage.getItem(this.localStorageId);return this.$sd_storageData="undefined"==typeof JSON?eval("("+storageDataStr+")"):JSON.parse(storageDataStr),this.$sd_storageData},saveLocalData:function(){var a=this;this.saveSettimeout&&clearTimeout(this.saveSettimeout),this.saveSettimeout=setTimeout(function(){if(null!=a.$sd_storageData&&null!=window.localStorage){var b=JSON.stringify(a.$sd_storageData);try{window.localStorage.setItem(a.localStorageId,b)}catch(c){}}},200)},clearLocalData:function(){this.saveSettimeout&&clearTimeout(this.saveSettimeout),window.localStorage.setItem(this.localStorageId,"{}"),this.$sd_storageData={}},saveGridCompColumnArrToLocal:function(){var a=this.getLocalData();a.gridCompColumnArr=this.gridCompColumnArr.concat(this.gridCompColumnFixedArr),this.saveLocalData()},getGridCompColumnArrFromLocal:function(){var a=this.getLocalData();return null==a?null:null==a.gridCompColumnArr?null:a.gridCompColumnArr},getColumnAttr:function(a,b){for(var c=0;c<this.gridCompColumnArr.length;c++)if(this.gridCompColumnArr[c].options.field==b)return $(this.gridCompColumnArr[c].options).attr(a);return""},getColumnByField:function(a){for(var b=0;b<this.gridCompColumnArr.length;b++)if(this.gridCompColumnArr[b].options.field==a)return this.gridCompColumnArr[b];return null},formatWidth:function(a){return(a+"").indexOf("%")>0?a:parseInt(a)+"px"},swapEle:function(a,b){var c=a.next(),d=b.prev();b.insertBefore(c),a.insertAfter(d)},getString:function(a,b){return(null==a||a==undefined||"null"==a||"undefined"==a)&&(a=b),a},cloneObj:function(a){var b;if("object"==typeof a)if(null===a)b=null;else if(a instanceof Array){b=[];for(var c=0,d=a.length;d>c;c++)b.push(this.cloneObj(a[c]))}else{b={};for(var e in a)b[e]=this.cloneObj(a[e])}else b=a;return b},setDataSource:function(a){this.initVariable(),this.options.dataSource=a,this.initDataSource(),this.repaintDivs()},setDataSourceFun1:function(a){var b={};if(a.values){var c=new Array;$.each(a.values,function(){if(a.fields){var b={},d=this;$.each(a.fields,function(a){$(b).attr(this,d[a])}),c.push(b)}})}$(b).attr("values",c),this.setDataSource(b)},addOneRow:function(a,b){var c=this.dataSourceObj.rows.length;a>c&&(a=c);var d={};d.value=b,this.dataSourceObj.rows.splice(a,0,d);var e=this.createContentOneRow(d);$("#"+this.options.id+"_content_div tbody tr:eq("+a+")")[0]?$("#"+this.options.id+"_content_div tbody tr:eq("+a+")")[0].insertAdjacentHTML("beforeBegin",e):$("#"+this.options.id+"_content_div tbody")[0].insertAdjacentHTML("afterBegin",e);var e=this.createContentOneRow(d,"fixed");if($("#"+this.options.id+"_content_fixed_div tbody tr:eq("+a+")")[0]?$("#"+this.options.id+"_content_fixed_div tbody tr:eq("+a+")")[0].insertAdjacentHTML("beforeBegin",e):$("#"+this.options.id+"_content_fixed_div tbody")[0].insertAdjacentHTML("afterBegin",e),this.options.multiSelect){var e=this.createContentLeftMultiSelectRow(d);$("#"+this.options.id+"_content_multiSelect div:eq("+a+")")[0]?$("#"+this.options.id+"_content_multiSelect div:eq("+a+")")[0].insertAdjacentHTML("beforeBegin",e):$("#"+this.options.id+"_content_multiSelect")[0].insertAdjacentHTML("afterBegin",e)}if(this.options.showNumCol){var e=this.createContentLeftNumColRow(c);$("#"+this.options.id+"_content_numCol")[0].insertAdjacentHTML("beforeEnd",e)}this.repairSumRow(),this.noRowsShowFun(),this.renderTypeFun(a,1)},addRows:function(a,b){var c="",d="",e="",f="",g=this,h=this.dataSourceObj.rows.length;a>h&&(a=h);var i=new Array;$.each(b,function(b){var c={};c.value=this,i.push(c),g.dataSourceObj.rows.splice(a+b,0,c)}),$.each(i,function(a){c+=g.createContentOneRow(this),f+=g.createContentOneRow(this,"fixed"),g.options.multiSelect&&(d+=g.createContentLeftMultiSelectRow(this)),g.options.showNumCol&&(e+=g.createContentLeftNumColRow(h+a))}),$("#"+this.options.id+"_content_div tbody tr:eq("+a+")")[0]?$("#"+this.options.id+"_content_div tbody tr:eq("+a+")")[0].insertAdjacentHTML("beforeBegin",c):$("#"+this.options.id+"_content_div tbody")[0].insertAdjacentHTML("afterBegin",c),$("#"+this.options.id+"_content_fixed_div tbody tr:eq("+a+")")[0]?$("#"+this.options.id+"_content_fixed_div tbody tr:eq("+a+")")[0].insertAdjacentHTML("beforeBegin",f):$("#"+this.options.id+"_content_fixed_div tbody")[0].insertAdjacentHTML("afterBegin",f),this.options.multiSelect&&($("#"+this.options.id+"_content_multiSelect div:eq("+a+")")[0]?$("#"+this.options.id+"_content_multiSelect div:eq("+a+")")[0].insertAdjacentHTML("beforeBegin",d):$("#"+this.options.id+"_content_multiSelect")[0].insertAdjacentHTML("afterBegin",d)),this.options.showNumCol&&$("#"+this.options.id+"_content_numCol")[0].insertAdjacentHTML("beforeEnd",e),this.repairSumRow(),this.noRowsShowFun(),this.renderTypeFun(a,b.length)},deleteOneRow:function(a){a=parseInt(a),this.dataSourceObj.rows.splice(a,1),$("#"+this.options.id+"_content_div tbody tr:eq("+a+")").remove(),$("#"+this.options.id+"_content_fixed_div tbody tr:eq("+a+")").remove(),$("#"+this.options.id+"_content_multiSelect >div:nth-child("+(this.dataSourceObj.rows.length+1)+")").remove(),$("#"+this.options.id+"_content_numCol >div:nth-child("+(this.dataSourceObj.rows.length+1)+")").remove(),this.repairSumRow(),this.noRowsShowFun()},deleteRows:function(a){var b=this;a.sort(function(a,b){return b-a}),$.each(a,function(){b.deleteOneRow(this)})},updateRow:function(a,b){this.deleteOneRow(a),this.addOneRow(a,b)},setRowSelect:function(a){("function"!=typeof this.options.onBeforeRowSelected||this.options.onBeforeRowSelected(a,this.dataSourceObj.rows[a].value))&&(this.dataSourceObj.rows[a].checked||(this.options.multiSelect?$("#"+this.options.id+"_content_multiSelect input:eq("+a+")")[0].checked=!0:(this.selectRowsObj.length>0&&(this.selectRowsObj[0].checked=!1),this.selectRows=new Array,this.selectRowsObj=new Array,$("#"+this.options.id+"_content_tbody tr").css("background",""),$("#"+this.options.id+"_content_tbody tr").css("color",""),$("#"+this.options.id+"_content_tbody tr a").css("color","")),$("#"+this.options.id+"_content_tbody tr:eq("+a+")").css("background","#00b0ff"),$("#"+this.options.id+"_content_tbody tr:eq("+a+")").css("color","#fff"),$("#"+this.options.id+"_content_tbody tr:eq("+a+") a").css("color","#fff"),this.selectRows.push(this.dataSourceObj.rows[a].value),this.selectRowsObj.push(this.dataSourceObj.rows[a]),this.dataSourceObj.rows[a].checked=!0,"function"==typeof this.options.onRowSelected&&this.options.onRowSelected(a,this.dataSourceObj.rows[a].value)))},setRowUnselect:function(a){var b=this;("function"!=typeof this.options.onBeforeRowUnSelected||this.options.onBeforeRowUnSelected(a,this.dataSourceObj.rows[a].value))&&this.dataSourceObj.rows[a].checked&&(this.options.multiSelect&&($("#"+this.options.id+"_content_multiSelect input:eq("+a+")")[0].checked=!1),$("#"+this.options.id+"_content_tbody tr:eq("+a+")").css("background",""),$("#"+this.options.id+"_content_tbody tr:eq("+a+")").css("color",""),$("#"+this.options.id+"_content_tbody tr:eq("+a+") a").css("color",""),$.each(this.selectRows,function(c){this==b.dataSourceObj.rows[a].value&&(b.selectRows.splice(c,1),b.selectRowsObj.splice(c,1))}),this.dataSourceObj.rows[a].checked=!1,"function"==typeof this.options.onRowUnSelected&&this.options.onRowUnSelected(a,this.dataSourceObj.rows[a].value))},setAllRowSelect:function(){if("function"!=typeof this.options.onBeforeAllRowSelected||this.options.onBeforeAllRowSelected(this.dataSourceObj.rows)){for(var a=0;a<this.dataSourceObj.rows.length;a++)this.setRowSelect(a);"function"==typeof this.options.onAllRowSelected&&this.options.onAllRowSelected(this.dataSourceObj.rows)}},setAllRowUnSelect:function(){if("function"!=typeof this.options.onBeforeAllRowUnSelected||this.options.onBeforeAllRowUnSelected(this.dataSourceObj.rows)){for(var a=0;a<this.dataSourceObj.rows.length;a++)this.setRowUnselect(a);"function"==typeof this.options.onAllRowSelected&&this.options.onAllRowUnSelected(this.dataSourceObj.rows)}},getSelectRows:function(){return this.selectRows},getAllRows:function(){var a=this;return this.allRows=new Array,this.dataSourceObj.rows&&$.each(this.dataSourceObj.rows,function(){a.allRows.push(this.value)}),this.allRows},getRowByIndex:function(a){return this.dataSourceObj.rows[a]},getAllChildRow:function(a){return a.allChildRowIndex&&a.allChildRow.length>0?a.allChildRow:(a.allChildRow=new Array,this.getAllChildRowFun(a,a.allChildRow),a.allChildRow)},getAllChildRowIndex:function(a){return a.allChildRowIndex&&a.allChildRowIndex.length>0?a.allChildRowIndex:(a.allChildRowIndex=new Array,this.getAllChildRowIndexFun(a,a.allChildRowIndex),a.allChildRowIndex)},getAllChildRowFun:function(a,b){var c=this;a.childRow.length>0&&(Array.prototype.push.apply(b,a.childRow),$.each(a.childRow,function(){c.getAllChildRowFun(this,b)}))},getAllChildRowIndexFun:function(a,b){var c=this;a.childRowIndex.length>0&&(Array.prototype.push.apply(b,a.childRowIndex),$.each(a.childRow,function(){c.getAllChildRowIndexFun(this,b)}))},setRenderType:function(a,b){var c=this.getColumnByField(a);c.options.renderType=b;var d=this.getIndexOfColumn(c);this.renderTypeByColumn(c,d)},setEditType:function(a,b){var c=this.getColumnByField(a);c.options.editType=b},setEditable:function(a){this.options.editable=a}},dataSource.prototype={sortRows:function(a,b){this.gridComp.options.showTree?this.treeSortRows(a,b):this.basicSortRows(a,b)},basicSortRows:function(a,b){var c=this;"asc"==b?this.rows.sort(function(b,d){var e=$(d.value).attr(a);e=c.gridComp.getString(e,"");var f=$(b.value).attr(a);f=c.gridComp.getString(f,"");try{return e.localeCompare(f)}catch(g){return 0}}):"desc"==b?this.rows.sort(function(b,d){var e=$(b.value).attr(a);e=c.gridComp.getString(e,"");var f=$(d.value).attr(a);f=c.gridComp.getString(f,"");try{return e.localeCompare(f)}catch(g){return 0}}):(this.rows=new Array,this.options.values&&$.each(this.options.values,function(){var a={};a.value=this,c.rows.push(a)}))},treeSortRows:function(){var a=this;if(this.rows=new Array,this.hasParentRows=new Array,this.nothasParentRows=new Array,this.options.values){$.each(this.options.values,function(){var b={},c=$(this),d=a.gridComp.options.keyField,e=a.gridComp.options.parentKeyField,f=a.gridComp.getString(c.attr(d),""),g=a.gridComp.getString(c.attr(e),"");b.value=this,b.keyValue=f,b.parentKeyValue=g,""==g?a.nothasParentRows.push(b):a.hasParentRows.push(b),a.rows.push(b)}),$.each(this.hasParentRows,function(b){var c=this.parentKeyValue,d=!1;$.each(a.rows,function(){this.keyValue==c&&(d=!0)}),d||(a.hasParentRows.splice(b,0),a.nothasParentRows.push(this))}),a.rows=new Array;var b=0;$.each(this.nothasParentRows,function(){this.level=b,a.rows.push(this),a.pushChildRows(this,b)})}},pushChildRows:function(a,b){var c=a.keyValue,d=this,e=parseInt(b)+1,f=!1,g=new Array,h=new Array;$.each(this.hasParentRows,function(a){if(this&&this.parentKeyValue==c){f=!0,this.level=e,d.rows.push(this),g.push(this);var b=parseInt(d.rows.length-1);h.push(b),d.hasParentRows.splice(a,0),d.pushChildRows(this,e)}}),a.hasChild=f,a.childRow=g,a.childRowIndex=h},getSumValue:function(a,b){var c=null;return b.options.sumCol&&$.each(this.rows,function(){var d=$(this.value).attr(a);c+="int"==b.options.dataType?parseInt(d):parseFloat(d)}),null!=c&&c!=undefined&&"null"!=c&&"undefined"!=c?c+"":""}},$.fn.grid=function(a){var b=new gridComp(this,a);return b}}(jQuery,window,document);